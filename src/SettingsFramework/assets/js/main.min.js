!function(e,t){e(".wpsf-select2").select2();var i={cache:function(){i.els={},i.vars={},i.els.tab_links=e(".wpsf-nav__item-link"),i.els.submit_button=e(".wpsf-button-submit")},on_ready:function(){i.cache(),i.setup_groups(),i.tabs.watch(),i.watch_submit(),i.control_groups(),i.setup_visual_radio_checkbox_field(),i.importer.init(),e(t.body).on("change","input, select, textarea",i.control_groups)},tabs:{watch:function(){var t=i.tabs.get_tab_id();t&&i.tabs.set_active_tab(t),i.els.tab_links.on("click",(function(t){var s=e(this).attr("href");i.tabs.set_active_tab(s),t.preventDefault()}))},has_storage:"undefined"!=typeof Storage,set_tab_id:function(e){i.tabs.has_storage&&localStorage.setItem(i.tabs.get_option_page()+"_wpsf_tab_id",e)},get_tab_id:function(){return window.location.hash&&e(`.wpsf-nav a[href="${window.location.hash}"]`).length?window.location.hash:!!i.tabs.has_storage&&localStorage.getItem(i.tabs.get_option_page()+"_wpsf_tab_id")},set_active_tab:function(t){var s=e(t),n=e('.wpsf-nav__item-link[href="'+t+'"]');(s.length<=0||n.length<=0)&&(t=(n=e(".wpsf-nav__item-link").first()).attr("href"),s=e(t)),i.els.tab_links.parent().removeClass("wpsf-nav__item--active"),e('a[href="'+t+'"]').parent().addClass("wpsf-nav__item--active"),e(".wpsf-tab").removeClass("wpsf-tab--active"),s.addClass("wpsf-tab--active"),i.tabs.set_tab_id(t)},get_option_page:function(){return e('input[name="option_page"]').val()}},setup_groups:function(){i.reindex_groups(),e(t).on("click",".wpsf-group__row-add",(function(){var t=e(this).closest(".wpsf-group"),s=e(this).closest(".wpsf-group__row"),n=e(this).data("template"),o=e(e("#"+n).html());return o.find(".wpsf-group__row-id").val(i.generate_random_id()),s.after(o),i.reindex_group(t),i.trigger_dynamic_fields(),!1})),e(t).on("click",".wpsf-group__row-remove",(function(){var e=jQuery(this).closest(".wpsf-group");return jQuery(this).closest(".wpsf-group__row").remove(),i.reindex_group(e),!1}))},generate_random_id:function(){return(Number(String(Math.random()).slice(2))+Date.now()+Math.round(performance.now())).toString(36)},reindex_groups:function(){var e=jQuery(".wpsf-group");e.length<=0||e.each((function(e,t){i.reindex_group(jQuery(t))}))},reindex_group:function(t){var i=["class","id","name","data-datepicker"];1===t.find(".wpsf-group__row").length?t.find(".wpsf-group__row-remove").hide():t.find(".wpsf-group__row-remove").show(),t.find(".wpsf-group__row").each((function(t){e(this).removeClass("alternate"),t%2==0&&e(this).addClass("alternate"),e(this).find("input").each((function(){var s=this,n=jQuery(this).attr("name");void 0!==n&&!1!==n&&e(s).attr("name",n.replace(/\[\d+\]/,"["+t+"]")),e.each(s.attributes,(function(){this.name&&s&&e.inArray(this.name,i)>-1&&e(s).attr(this.name,this.value.replace(/\_\d+\_/,"_"+t+"_"))}))})),e(this).find(".wpsf-group__row-index span").html(t)}))},watch_submit:function(){i.els.submit_button.on("click",(function(){e(this).closest(".wpsf-settings").find("form").first().submit()}))},control_groups:function(){e(".show-if").each((function(t){var s=e(this),n=s.parent().prop("nodeName").toLowerCase();"td"!==n&&"label"!==n||(s.closest("tr").hide(),i.maybe_show_element(s,(function(){s.closest("tr").show()}))),"li"===n&&(s.closest("li").hide(),i.maybe_show_element(s,(function(){s.closest("li").show()}))),"div"===n&&(s.prev().hide(),s.next().hide(),s.next().hasClass("wpsf-section-description")&&s.next().next().hide(),i.maybe_show_element(s,(function(){s.prev().show(),s.next().show(),s.next().hasClass("wpsf-section-description")&&s.next().next().show()})))})),e(".hide-if").each((function(t){var s=e(this),n=s.parent().prop("nodeName").toLowerCase();"td"!==n&&"label"!==n||(s.closest("tr").show(),i.maybe_hide_element(s,(function(){s.closest("tr").hide()}))),"li"===n&&(s.closest("li").show(),i.maybe_hide_element(s,(function(){s.closest("li").hide()}))),"div"===n&&(s.prev().show(),s.next().show(),s.next().hasClass("wpsf-section-description")&&s.next().next().show(),i.maybe_hide_element(s,(function(){s.prev().hide(),s.next().hide(),s.next().hasClass("wpsf-section-description")&&s.next().next().hide()})))}))},maybe_show_element:function(e,t){var s=e.attr("class").split(/\s+/).filter((function(e){return e.includes("show-if--")}));Array.from(s).forEach((function(e){var s=e.replace("show-if--","");if(s.includes("&&")){var n=s.split("&&"),o=!0;if(Array.from(n).forEach((function(e){i.get_show_item_bool(o,e)||(o=!1)})),o)return void t()}else{o=!0;if(o=i.get_show_item_bool(o,s))return void t()}}))},maybe_hide_element:function(e,t){var s=e.attr("class").split(/\s+/).filter((function(e){return e.includes("hide-if--")}));Array.from(s).forEach((function(e){var s=e.replace("hide-if--","");if(s.includes("&&")){var n=s.split("&&"),o=!0;if(Array.from(n).forEach((function(e){i.get_show_item_bool(o,e)||(o=!1)})),o)return void t()}else{o=!0;if(o=i.get_show_item_bool(o,s))return void t()}}))},get_show_item_bool:function(e=!0,t){var s=t.split("==="),n=s[0],o=s[1].split("||"),a=i.get_controller_value(n);return o.includes(a)||(e=!e),e},get_controller_value:function(t){var i=e("#"+t);"checkbox"!==i.attr("type")&&"radio"!==i.attr("type")||(i=e("#"+t+":checked"));var s=i.val();return void 0===s&&(s=""),s.toString()},setup_visual_radio_checkbox_field:function(){var i="wpsf-visual-field__item--checked";e(t).on("change",'.wpsf-visual-field input[type="radio"], .wpsf-visual-field input[type="checkbox"]',(function(){var t=e(this),s=t.closest(".wpsf-visual-field"),n=t.closest(".wpsf-visual-field__item"),o=s.find("."+i);s.hasClass("wpsf-visual-field--image-checkboxes")?t.prop("checked")?n.addClass(i):n.removeClass(i):(o.removeClass(i),n.addClass(i))}))},importer:{init:function(){e(".wpsf-import__button").click((function(){e(this).parent().find(".wpsf-import__file_field").trigger("click")})),e(".wpsf-import__file_field").change((function(t){$this=e(this),$td=$this.closest("td");var s=$this.get(0),n="",o=$td.find(".wpsf_import_nonce").val();wpsf_import_option_group=$td.find(".wpsf_import_option_group").val(),void 0!==s.files[0]?confirm("Are you sure you want to overrid existing setting?")&&i.importer.read_file_text(s.files[0],(function(t){try{JSON.parse(t),n=t}catch{n=!1,alert(wpsf_vars.invalid_file)}n&&($td.find(".spinner").addClass("is-active"),e.ajax({url:"admin-ajax.php",type:"POST",data:{action:"wpsf_import_settings",settings:n,option_group:wpsf_import_option_group,_wpnonce:o},success:function(e){e.success?location.reload():alert(wpsf_vars.something_went_wrong),$td.find(".spinner").removeClass("is-active")}}))})):alert(wpsf_vars.select_file)}))},read_file_text(e,t){const i=new FileReader;i.readAsText(e),i.onload=()=>{t(i.result)}}}};e(t).ready(i.on_ready)}(jQuery,document);